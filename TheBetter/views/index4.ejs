<!DOCTYPE html>
<html>
  <head>
    <title>The Better</title>
    <link rel='stylesheet' href='/css/main.css' />
  
	<style>
		div#wrap{
			width: 100vw;
			height: 820px;
			display: flex;
		}

		div#wrap div{
			display: inline-block;
		}
		
		div.sideBar {
			width: 260px;
			height: 820px;
		}

		div.pallett1 {
			background-color: #F3722C;
			width: 190px;
			height: 500px;
		}
		div.pallett1 svg.puzzle{
			width: 76.6px;
			height: 80px;
			left: 50px;
			position: absolute;
			-webkit-user-drag: none;
		}
		.st0{fill:#FFFFFF;}
		.st1{fill:#F3722C;}

		div.pallett1 svg:nth-of-type(1) {
			top : 150px;
		}
		div.pallett1 svg:nth-of-type(2) {
			top : 260px;
		}
		div.pallett1 svg:nth-of-type(3) {
			top : 370px;
		}
		div.pallett1 svg:nth-of-type(4) {
			top : 480px;
		}

		
		div.pallett2 {
			background-color: #18617A;
			width: 190px;
			height: 200px;
		}

		div.pallett2 .puzzle{
			width: 92px;
			height: 80px;
			position: absolute;
			-webkit-user-drag: none;
			left: 50px;
		}

		div.pallett2 div:nth-of-type(1){
			top:650px;
		}
		div.pallett2 svg:nth-of-type(1){
			top:740px;
		}

		#num .st1{fill:#18617A;}
		#oper-e .st1{fill:#000000;}

		input.inputNum {
			width: 94px;
			height: 75px;
			border: none;
			background-color: transparent;
			position: absolute;
			font-family: 'Black Han Sans', sans-serif;
			font-size: 50px;
			text-align: center;
			line-height: 75px;
			left: 23px;
			top: 23px;
			color: #FFFFFF;
		}

		input.inputNum:focus {
			outline: none;
		}

		div.sketchBook_box {
			width: 1400px;
			height: 820px;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		div.sketchBook {
			width: 1380px;
			height: 750px;
			background-color: #FFF;
			border-radius: 10px;
			box-shadow: 5px 5px 5px 1px rgba(0, 0, 0, .1);
		}

	</style>

	</head>


  <body>

	<% include ./include/header_menu.ejs %>
	
	<div id = "wrap">
		<div class = "sideBar">
			
			<div class="pallett1">
				<svg data-id="rootPuzzle" class ="puzzle oper" version="1.1" id="oper-p" 
						xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
						y="0px" viewBox="0 0 115 120.1" style="enable-background:new 0 0 115 120.1;" xml:space="preserve">
					<g>
						<path class="st0" d="M105.4,46.6c3.8,0,7.1,1.5,9.6,4V35.1c0-7-5.8-12.8-12.8-12.8H68.1c2.1-2.4,3.4-5.5,3.4-8.9
							C71.6,6,65.5,0,58.1,0S44.7,6,44.7,13.4c0,3.4,1.3,6.6,3.4,8.9H12.8C5.8,22.4,0,28.1,0,35.1v14.9c2.4-2.1,5.5-3.4,8.9-3.4
							c7.4,0,13.4,6,13.4,13.4c0,7.4-6,13.4-13.4,13.4c-3.4,0-6.6-1.3-8.9-3.4V85c0,7,5.8,12.8,12.8,12.8h35.4c-2.1,2.4-3.4,5.5-3.4,8.9
							c0,7.4,6,13.4,13.4,13.4s13.4-6,13.4-13.4c0-3.4-1.3-6.6-3.4-8.9h34.1c7,0,12.8-5.8,12.8-12.8V69.4c-2.4,2.5-5.8,4-9.6,4
							c-7.4,0-13.4-6-13.4-13.4C92,52.6,98,46.6,105.4,46.6z"/>
						<path class="st1" d="M74.3,53.5H64.1V43.3c0-3.9-3-7.1-6.6-7.1c-3.6,0-6.6,3.2-6.6,7.1v10.2H40.7c-3.9,0-7.1,3-7.1,6.6
							c0,3.6,3.2,6.6,7.1,6.6h10.2v10.2c0,3.9,3,7.1,6.6,7.1c3.6,0,6.6-3.2,6.6-7.1V66.6h10.2c3.9,0,7.1-3,7.1-6.6
							C81.3,56.4,78.2,53.5,74.3,53.5z"/>
					</g>
				</svg>
				<svg data-id="rootPuzzle" class ="puzzle oper" version="1.1" id="oper-m" 
						xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
						y="0px" viewBox="0 0 115 120.1" style="enable-background:new 0 0 115 120.1;" xml:space="preserve">
					<g>
						<path class="st0" d="M105.4,46.6c3.8,0,7.1,1.5,9.6,4V35.1c0-7-5.8-12.8-12.8-12.8H68.1c2.1-2.4,3.4-5.5,3.4-8.9
							C71.6,6,65.5,0,58.1,0S44.7,6,44.7,13.4c0,3.4,1.3,6.6,3.4,8.9H12.8C5.8,22.4,0,28.1,0,35.1v14.9c2.4-2.1,5.5-3.4,8.9-3.4
							c7.4,0,13.4,6,13.4,13.4c0,7.4-6,13.4-13.4,13.4c-3.4,0-6.6-1.3-8.9-3.4V85c0,7,5.8,12.8,12.8,12.8h35.4c-2.1,2.4-3.4,5.5-3.4,8.9
							c0,7.4,6,13.4,13.4,13.4s13.4-6,13.4-13.4c0-3.4-1.3-6.6-3.4-8.9h34.1c7,0,12.8-5.8,12.8-12.8V69.4c-2.4,2.5-5.8,4-9.6,4
							c-7.4,0-13.4-6-13.4-13.4C92,52.6,98,46.6,105.4,46.6z"/>
						<path class="st1" d="M81.3,60.1c0,3.6-3.2,6.6-7.1,6.6H40.7c-3.9,0-7.1-3-7.1-6.6c0-3.6,3.2-6.6,7.1-6.6h33.6
							C78.2,53.5,81.3,56.4,81.3,60.1z"/>
					</g>
				</svg>
				<svg data-id="rootPuzzle" class ="puzzle oper" version="1.1" id="oper-d" 
					xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
					y="0px" viewBox="0 0 115 120.1" style="enable-background:new 0 0 115 120.1;" xml:space="preserve">
					<g>
						<path class="st0" d="M105.4,46.6c3.8,0,7.1,1.5,9.6,4V35.1c0-7-5.8-12.8-12.8-12.8H68.1c2.1-2.4,3.4-5.5,3.4-8.9
							C71.6,6,65.5,0,58.1,0S44.7,6,44.7,13.4c0,3.4,1.3,6.6,3.4,8.9H12.8C5.8,22.4,0,28.1,0,35.1v14.9c2.4-2.1,5.5-3.4,8.9-3.4
							c7.4,0,13.4,6,13.4,13.4c0,7.4-6,13.4-13.4,13.4c-3.4,0-6.6-1.3-8.9-3.4V85c0,7,5.8,12.8,12.8,12.8h35.4c-2.1,2.4-3.4,5.5-3.4,8.9
							c0,7.4,6,13.4,13.4,13.4s13.4-6,13.4-13.4c0-3.4-1.3-6.6-3.4-8.9h34.1c7,0,12.8-5.8,12.8-12.8V69.4c-2.4,2.5-5.8,4-9.6,4
							c-7.4,0-13.4-6-13.4-13.4C92,52.6,98,46.6,105.4,46.6z"/>
						<g>
							<path class="st1" d="M81.3,60.1c0,3.6-3.2,6.6-7.1,6.6H40.7c-3.9,0-7.1-3-7.1-6.6c0-3.6,3.2-6.6,7.1-6.6h33.6
								C78.2,53.5,81.3,56.4,81.3,60.1z"/>
							<circle class="st1" cx="57.5" cy="42.9" r="6.6"/>
							<circle class="st1" cx="57.5" cy="77.2" r="6.6"/>
						</g>
					</g>
				</svg>
				<svg data-id="rootPuzzle" class ="puzzle oper" version="1.1" id="oper-x"  
					xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
					y="0px" viewBox="0 0 115 120.1" style="enable-background:new 0 0 115 120.1;" xml:space="preserve">
				<g>
					<path class="st0" d="M105.4,46.6c3.8,0,7.1,1.5,9.6,4V35.1c0-7-5.8-12.8-12.8-12.8H68.1c2.1-2.4,3.4-5.5,3.4-8.9
						C71.6,6,65.5,0,58.1,0S44.7,6,44.7,13.4c0,3.4,1.3,6.6,3.4,8.9H12.8C5.8,22.4,0,28.1,0,35.1v14.9c2.4-2.1,5.5-3.4,8.9-3.4
						c7.4,0,13.4,6,13.4,13.4c0,7.4-6,13.4-13.4,13.4c-3.4,0-6.6-1.3-8.9-3.4V85c0,7,5.8,12.8,12.8,12.8h35.4c-2.1,2.4-3.4,5.5-3.4,8.9
						c0,7.4,6,13.4,13.4,13.4s13.4-6,13.4-13.4c0-3.4-1.3-6.6-3.4-8.9h34.1c7,0,12.8-5.8,12.8-12.8V69.4c-2.4,2.5-5.8,4-9.6,4
						c-7.4,0-13.4-6-13.4-13.4C92,52.6,98,46.6,105.4,46.6z"/>
					<path class="st1" d="M66.8,60.1l7.2-7.2c2.7-2.7,2.9-7.1,0.3-9.7c-2.6-2.6-6.9-2.4-9.7,0.3l-7.2,7.2l-7.2-7.2
						c-2.7-2.7-7.1-2.9-9.7-0.3c-2.6,2.6-2.4,6.9,0.3,9.7l7.2,7.2L41,67.3c-2.7,2.7-2.9,7.1-0.3,9.7c2.6,2.6,6.9,2.4,9.7-0.3l7.2-7.2
						l7.2,7.2c2.7,2.7,7.1,2.9,9.7,0.3c2.6-2.6,2.4-6.9-0.3-9.7L66.8,60.1z"/>
				</g>
				</svg>
			</div>

			<div class="pallett2">
				<div data-id="rootPuzzle" class ="puzzle num" id="num" >
					<svg data-id="rootPuzzle"  version="1.1" 
						 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
						y="0px" viewBox="0 0 138.5 120" style="enable-background:new 0 0 138.5 120;" xml:space="preserve">
						<g>
							<path class="st0" d="M125.1,46.6c-3.4,0-6.6,1.3-8.9,3.4V35.1c0-7-5.7-12.8-12.8-12.8H79.5c2.1-2.4,3.4-5.5,3.4-8.9
								C83,6,77,0,69.6,0S56.2,6,56.2,13.4c0,3.4,1.3,6.6,3.4,8.9H35.7c-7,0-12.8,5.7-12.8,12.8v15.5c-2.4-2.5-5.8-4-9.6-4
								C6,46.6,0,52.6,0,60s6,13.4,13.4,13.4c3.8,0,7.1-1.5,9.6-4v15.5c0,7,5.7,12.8,12.8,12.8h23.9c-2.1,2.4-3.4,5.5-3.4,8.9
								c0,7.4,6,13.4,13.4,13.4S83,114,83,106.6c0-3.4-1.3-6.6-3.4-8.9h23.9c7,0,12.8-5.7,12.8-12.8V70c2.4,2.1,5.5,3.4,8.9,3.4
								c7.4,0,13.4-6,13.4-13.4S132.5,46.6,125.1,46.6z"/>
							<g>
								<path class="st1" d="M61.1,73.9v-4.2c0-2.7,0.3-4.9,0.9-6.6c0.6-1.7,1.9-3.1,3.8-4.3c1.5-0.9,2.9-1.7,4.1-2.5
									c1.2-0.7,2.2-1.4,2.9-2.1c1.1-1,1.8-1.9,2.2-2.8c0.4-0.9,0.6-1.9,0.6-3.1c0-1.6-0.6-2.9-1.7-3.8c-1.1-0.9-2.4-1.4-4-1.4
									c-1.6,0-3,0.4-4.3,1.1c-1.3,0.8-2.1,1.9-2.5,3.3c-0.5,1.7-1.4,2.9-2.8,3.8c-1.3,0.9-3,1.2-4.9,1.1c-0.8,0-1.5-0.2-2.3-0.5
									c-0.7-0.3-1.4-0.7-1.9-1.3c-0.5-0.6-1-1.2-1.3-2C49.6,48,49.5,47,49.5,46c0-2.1,0.6-4.1,1.7-5.9c1.1-1.8,2.6-3.4,4.4-4.7
									c1.8-1.3,4-2.4,6.4-3.1c2.4-0.8,5-1.1,7.8-1.1c2.9,0,5.5,0.4,7.9,1.1c2.4,0.7,4.5,1.8,6.2,3.2c1.7,1.4,3.1,3.2,4.1,5.4
									c1,2.2,1.5,4.7,1.5,7.7c0,2.3-0.3,4.4-0.8,6.1c-0.6,1.7-1.4,3.3-2.7,4.8c-1.1,1.2-2.4,2.4-3.9,3.6c-1.5,1.2-3.2,2.3-4.9,3.4
									c-1,0.6-1.6,1.3-1.9,2c-0.3,0.7-0.4,1.5-0.4,2.4v3.1H61.1z M60.7,84.1c0-2.2,0.6-3.9,1.9-5.1c1.3-1.2,3.1-1.9,5.4-1.9
									s4.2,0.6,5.4,1.9c1.3,1.3,1.9,3,1.9,5.1c0,2.1-0.6,3.8-1.9,5.1c-1.3,1.3-3.1,1.9-5.4,1.9s-4.2-0.6-5.4-1.9
									C61.3,88,60.7,86.3,60.7,84.1z"/>
							</g>
						</g>
				   </svg>	
				</div>

				<svg data-id="rootPuzzle" class ="puzzle oper" version="1.1" id="oper-e" 
					xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
					y="0px" viewBox="0 0 114.9 120" style="enable-background:new 0 0 114.9 120;" xml:space="preserve">
					<g>
						<path class="st0" d="M105.3,46.6c3.8,0,7.1,1.5,9.6,4V35.1c0-7-5.7-12.8-12.8-12.8H68.1c2.1-2.4,3.4-5.5,3.4-8.9
							C71.5,6,65.5,0,58.1,0S44.7,6,44.7,13.4c0,3.4,1.3,6.6,3.4,8.9H12.8C5.7,22.3,0,28.1,0,35.1V50c2.4-2.1,5.5-3.4,8.9-3.4
							c7.4,0,13.4,6,13.4,13.4s-6,13.4-13.4,13.4c-3.4,0-6.6-1.3-8.9-3.4v14.9c0,7,5.7,12.8,12.8,12.8h35.3c-2.1,2.4-3.4,5.5-3.4,8.9
							c0,7.4,6,13.4,13.4,13.4s13.4-6,13.4-13.4c0-3.4-1.3-6.6-3.4-8.9h34.1c7,0,12.8-5.7,12.8-12.8V69.4c-2.4,2.5-5.8,4-9.6,4
							c-7.4,0-13.4-6-13.4-13.4S97.9,46.6,105.3,46.6z"/>
					</g>
					<g>
						<path class="st1" d="M85.6,48.7c0,4.3-3.8,7.8-8.4,7.8H37.6c-4.6,0-8.4-3.5-8.4-7.8s3.8-7.8,8.4-7.8h39.7C81.9,40.9,85.6,44.4,85.6,48.7z"/>
						<path class="st1" d="M85.6,71.3c0,4.3-3.8,7.8-8.4,7.8H37.6c-4.6,0-8.4-3.5-8.4-7.8c0-4.3,3.8-7.8,8.4-7.8h39.7C81.9,63.5,85.6,67,85.6,71.3z"
							/>
					</g>
				</svg>

			</div>

		</div>
		<div class = "sketchBook_box" >
			<div class = "sketchBook" droppable="true" >

			</div>
		</div>
		<div class="sideBar">

		</div>
	</div>
  
	</body>

	<script>

	document.addEventListener("DOMContentLoaded", (e) => {
		
		const puzzle = document.querySelectorAll(".puzzle");
		// const rootPuzzle = document.querySelectorAll('img[data-id="rootPuzzle"]');
		let dragging = false; // 마우스 다운된 상태냐?
		let offset = { x: 0, y: 0 };
		let current = null;
		let i = 1;

		// 마우스가 눌려있을 때
		document.addEventListener("mousedown", (e) => {
			offset.x = e.offsetX;
			offset.y = e.offsetY;
			
			if(e.target.tagName === "path" || e.target.tagName === "svg" || e.target.tagName === "circle" ){

				const puzzleA  = e.target.closest('.puzzle');
				// 정확히 퍼즐을 선택했을 때만 실행되게
				if (puzzleA) dragging = true;
				if (puzzleA.dataset.id === "rootPuzzle") {
					let newNode = puzzleA.cloneNode(true);
					let st0 = newNode.querySelector(".st0");
					let st1 = new Array() ;
					st1 = newNode.querySelectorAll(".st1");
					console.log("복사된객체 : ", newNode)
					current = newNode;
					newNode.dataset.id = Math.random().toString(36).substr(2, 10);
					// 10자리랜덤문자열생성

					if(puzzleA.classList.contains("oper")) {
						newNode.style.width = "115px";
						st0.style.fill = "#F3722C";
						if(puzzleA.id === "oper-e") {
							st0.style.fill = "#f9c74f";
						}
						for(let i = 0 ; i < st1.length ; i ++) {
							st1[i].style.fill = "#FFFFFF";
						}

					} else if(puzzleA.classList.contains("num")) {
						newNode.style.width = "138.5px"; 
						st0.style.fill = "#18617a";
						st1[0].style.display = "none";
						const input = document.createElement('input')
						input.classList.add('inputNum')
						newNode.appendChild(input)
						
					}
					newNode.style.height = "120px";
					newNode.dataset.num = i++;
					newNode.style.zIndex = 2;
					newNode.style.position = "absolute";
					newNode.style.WebkitUserDrag = "none";
					newNode.style.left = e.pageX - offset.x + "px";
					newNode.style.top = e.pageY - offset.y + "px";
					document.body.appendChild(newNode);
				} else {
					current = puzzleA;
				}
			}

		});

		document.addEventListener("mousemove", (e) => {
			if (dragging) {
				current.style.left = e.pageX - offset.x + "px";
				current.style.top = e.pageY - offset.y + "px";
			}
		});
	
		document.addEventListener("mouseup", (e) => {
			dragging = false;
		});


	});
	</script>
</html>
